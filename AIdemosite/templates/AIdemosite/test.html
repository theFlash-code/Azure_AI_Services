{% extends 'AIdemosite/base.html' %} {% block content %} {% load static %}
<!-- 
<button
  id="record_btn"
  class="btn btn-outline-secondary"
  onclick="startRecord()"
>
  Start record
</button>
<button id="stop__btn" class="btn btn-outline-secondary" onclick="stopRecord()">
  Stop recording
</button>
<div class="audio">
  <audio controls="controls" id="audio"></audio>
</div>

<script src="{% static 'js/recorder.js'%}"></script>
<script>
  var recorder;
  var stream;
  var url;
  function startRecord() {
    var device = navigator.mediaDevices.getUserMedia({ audio: true });
    var items = [];
    device.then((stream) => {
      recorder = new MediaRecorder(stream);
      this.stream = stream;
      recorder.ondataavailable = (e) => {
        items.push(e.data);
        if (recorder.state == "inactive") {
          var blob = new Blob(items, { type: "audio/wav" });
          var audio = document.getElementById("audio");
          url = URL.createObjectURL(blob);
          audio.setAttribute("src", url);
        }
      };
      recorder.start();
    });
  }
  function stopRecord() {
    recorder.stop();
    stream.getTracks().forEach(function (track) {
      if (track.readyState == "live" && track.kind === "audio") {
        track.stop();
      }
    });
    recorder.exportWAV(function (e) {
      recorder.clear();
      Recorder.forceDownload(e, "audio.wav");
    });
    var myHeaders = new Headers();
    myHeaders.append(
      "Ocp-Apim-Subscription-Key",
      "ac1b8fe3034344a787dc45b06243f51b"
    );
    myHeaders.append("Content-Type", "audio/wav");
    myHeaders.append(
      "Authorization",
      "Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJyZWdpb24iOiJlYXN0YXNpYSIsInN1YnNjcmlwdGlvbi1pZCI6IjZkZTEwNjZhM2YzODQ2MTJhMjc3NzRmODFmMjY5MzcxIiwicHJvZHVjdC1pZCI6IlNwZWVjaFNlcnZpY2VzLkYwIiwiY29nbml0aXZlLXNlcnZpY2VzLWVuZHBvaW50IjoiaHR0cHM6Ly9hcGkuY29nbml0aXZlLm1pY3Jvc29mdC5jb20vaW50ZXJuYWwvdjEuMC8iLCJhenVyZS1yZXNvdXJjZS1pZCI6Ii9zdWJzY3JpcHRpb25zLzk3OWI0ODI1LTI1YTItNGE0NC1iNDViLTllYzE1ZmIzZDYwYy9yZXNvdXJjZUdyb3Vwcy9teUxlYXJuaW5nR3JvdXAvcHJvdmlkZXJzL01pY3Jvc29mdC5Db2duaXRpdmVTZXJ2aWNlcy9hY2NvdW50cy9sZWFybi1zcGVlY2hTZXJ2aWNlcyIsInNjb3BlIjoic3BlZWNoc2VydmljZXMiLCJhdWQiOiJ1cm46bXMuc3BlZWNoc2VydmljZXMuZWFzdGFzaWEiLCJleHAiOjE2NjY4NTIzNzUsImlzcyI6InVybjptcy5jb2duaXRpdmVzZXJ2aWNlcyJ9.NAY3G22dIH0LxeYHiZMi8rjRy1CBa9L7y16FCWDsgz0"
    );

    var file = "AIdemosite/Wav_868kb.wav";

    var requestOptions = {
      method: "POST",
      headers: myHeaders,
      body: file,
      redirect: "follow",
    };

    fetch(
      "https://eastasia.stt.speech.microsoft.com/speech/recognition/interactive/cognitiveservices/v1?language=en-US",
      requestOptions
    )
      .then((response) => response.text())
      .then((result) => console.log(result))
      .catch((error) => console.log("error", error));
  }

  // recorder.js
</script>
 -->
<!DOCTYPE html>
<html>
  <head>
    <title>Microsoft Cognitive Services Speech SDK JavaScript Quickstart</title>
    <meta charset="utf-8" />
  </head>
  <body
    style="
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      font-size: 13px;
    "
  >
    <!-- <uidiv> -->
    <div id="warning">
      <h1 style="font-weight: 500">
        Speech Recognition Speech SDK not found
        (microsoft.cognitiveservices.speech.sdk.bundle.js missing).
      </h1>
    </div>

    <div id="content" style="display: none">
      <table width="100%">
        <tr>
          <td></td>
          <td>
            <h1 style="font-weight: 500">
              Microsoft Cognitive Services Speech SDK JavaScript Quickstart
            </h1>
          </td>
        </tr>

        <tr>
          <td></td>
          <td>
            <button id="startRecognizeOnceAsyncButton">
              Start recognition
            </button>
          </td>
        </tr>
        <tr>
          <td valign="top">Results</td>
          <td>
            <textarea
              id="phraseDiv"
              style="display: inline-block; width: 500px; height: 200px"
            ></textarea>
          </td>
        </tr>
      </table>
    </div>
    <!-- </uidiv> -->

    <!-- <speechsdkref> -->
    <!-- Speech SDK reference sdk. -->
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <!-- </speechsdkref> -->

    <!-- <quickstartcode> -->
    <!-- Speech SDK USAGE -->
    <script src="{% static 'js/speech_service.js'%}">
      // status fields and start button in UI
    </script>
    <!-- </quickstartcode> -->
  </body>
</html>
{% endblock %}
